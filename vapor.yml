id: 44297
name: ChurchWorld
environments:
  production:
    domain: app.churchworld.io
    database: churchworld-db-prod
    storage: churchworld-prod
    runtime: docker
    memory: 1024
    cli-memory: 512
    cli-timeout: 600
    concurrency: 50
    queue-concurrency: 5
    gateway-version: 2
    build:
      - 'COMPOSER_MIRROR_PATH_REPOS=1 composer install --no-dev'
      - 'php artisan event:cache'
      - 'yarn --frozen-lockfile && yarn run prod && rm -rf node_modules'
    deploy:
      - 'php artisan migrate --force'
    queues:
      - default
      - mail
  staging:
    domain: staging.churchworld.io
    database: churchworld-db-staging
    storage: churchworld-staging
    runtime: docker
    memory: 1024
    cli-memory: 512
    cli-timeout: 600
    concurrency: 10
    queue-concurrency: 2
    gateway-version: 2
    build:
      - 'COMPOSER_MIRROR_PATH_REPOS=1 composer install'
      - 'php artisan event:cache'
      - 'yarn --frozen-lockfile && yarn run dev && rm -rf node_modules'
    deploy:
      - 'php artisan migrate --force'
    queues:
      - default
      - mail
