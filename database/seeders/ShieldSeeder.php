<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use Spatie\Permission\Models\Permission;
use Spatie\Permission\Models\Role;

class ShieldSeeder extends Seeder
{
    public static function makeDirectPermissions(string $directPermissions): void
    {
        if (! blank($permissions = json_decode($directPermissions, true))) {
            foreach ($permissions as $permission) {
                if (Permission::whereName($permission)->doesntExist()) {
                    Permission::create([
                        'name' => $permission['name'],
                        'guard_name' => $permission['guard_name'],
                    ]);
                }
            }
        }
    }

    protected static function makeRolesWithPermissions(string $rolesWithPermissions): void
    {
        if (! blank($rolePlusPermissions = json_decode($rolesWithPermissions, true))) {
            foreach ($rolePlusPermissions as $rolePlusPermission) {
                $role = Role::firstOrCreate([
                    'name' => $rolePlusPermission['name'],
                    'guard_name' => $rolePlusPermission['guard_name'],
                ]);

                if (! blank($rolePlusPermission['permissions'])) {
                    $role->givePermissionTo($rolePlusPermission['permissions']);
                }
            }
        }
    }

    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        app()[\Spatie\Permission\PermissionRegistrar::class]->forgetCachedPermissions();

        $rolesWithPermissions = '[{"name":"Owner","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub","billing"]},{"name":"Member","guard_name":"web","permissions":["view posts"]},{"name":"Owner","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub","billing"]},{"name":"Member","guard_name":"web","permissions":["view posts"]},{"name":"Owner","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub","billing"]},{"name":"Owner","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub","billing"]},{"name":"Member","guard_name":"web","permissions":["view posts"]},{"name":"Owner","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub","billing"]},{"name":"Member","guard_name":"web","permissions":["view posts"]},{"name":"Owner","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub","billing"]},{"name":"Member","guard_name":"web","permissions":["view posts"]},{"name":"Owner","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub","billing"]},{"name":"Member","guard_name":"web","permissions":["view posts"]},{"name":"Owner","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub","billing"]},{"name":"Member","guard_name":"web","permissions":["view posts"]},{"name":"Owner","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub","billing"]},{"name":"Member","guard_name":"web","permissions":["view posts"]},{"name":"Owner","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub","billing"]},{"name":"Member","guard_name":"web","permissions":["view posts"]},{"name":"Owner","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub","billing"]},{"name":"Member","guard_name":"web","permissions":["view posts"]},{"name":"Owner","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub","billing"]},{"name":"Member","guard_name":"web","permissions":["view posts"]},{"name":"Owner","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub","billing"]},{"name":"Member","guard_name":"web","permissions":["view posts"]},{"name":"Admin","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub"]},{"name":"Moderator","guard_name":"web","permissions":["view posts","create posts","update posts","delete posts"]},{"name":"Editor","guard_name":"web","permissions":["view posts","create posts","update posts"]},{"name":"Admin","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub"]},{"name":"Moderator","guard_name":"web","permissions":["view posts","create posts","update posts","delete posts"]},{"name":"Editor","guard_name":"web","permissions":["view posts","create posts","update posts"]},{"name":"Admin","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub"]},{"name":"Moderator","guard_name":"web","permissions":["view posts","create posts","update posts","delete posts"]},{"name":"Editor","guard_name":"web","permissions":["view posts","create posts","update posts"]},{"name":"Admin","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub"]},{"name":"Moderator","guard_name":"web","permissions":["view posts","create posts","update posts","delete posts"]},{"name":"Editor","guard_name":"web","permissions":["view posts","create posts","update posts"]},{"name":"Admin","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub"]},{"name":"Moderator","guard_name":"web","permissions":["view posts","create posts","update posts","delete posts"]},{"name":"Editor","guard_name":"web","permissions":["view posts","create posts","update posts"]},{"name":"Admin","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub"]},{"name":"Moderator","guard_name":"web","permissions":["view posts","create posts","update posts","delete posts"]},{"name":"Editor","guard_name":"web","permissions":["view posts","create posts","update posts"]},{"name":"Admin","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub"]},{"name":"Moderator","guard_name":"web","permissions":["view posts","create posts","update posts","delete posts"]},{"name":"Editor","guard_name":"web","permissions":["view posts","create posts","update posts"]},{"name":"Admin","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub"]},{"name":"Moderator","guard_name":"web","permissions":["view posts","create posts","update posts","delete posts"]},{"name":"Editor","guard_name":"web","permissions":["view posts","create posts","update posts"]},{"name":"Member","guard_name":"web","permissions":["view posts"]},{"name":"Admin","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub"]},{"name":"Moderator","guard_name":"web","permissions":["view posts","create posts","update posts","delete posts"]},{"name":"Editor","guard_name":"web","permissions":["view posts","create posts","update posts"]},{"name":"Admin","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub"]},{"name":"Moderator","guard_name":"web","permissions":["view posts","create posts","update posts","delete posts"]},{"name":"Editor","guard_name":"web","permissions":["view posts","create posts","update posts"]},{"name":"Admin","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub"]},{"name":"Moderator","guard_name":"web","permissions":["view posts","create posts","update posts","delete posts"]},{"name":"Editor","guard_name":"web","permissions":["view posts","create posts","update posts"]},{"name":"Admin","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub"]},{"name":"Moderator","guard_name":"web","permissions":["view posts","create posts","update posts","delete posts"]},{"name":"Editor","guard_name":"web","permissions":["view posts","create posts","update posts"]},{"name":"Admin","guard_name":"web","permissions":["create team","read team","update team","delete team","create post","read post","update post","delete post","create feed","read feed","update feed","delete feed","create award","read award","update award","delete award","create review","read review","update review","delete review","create event","read event","update event","delete event","create sub","read sub","update sub","delete sub"]},{"name":"Moderator","guard_name":"web","permissions":["view posts","create posts","update posts","delete posts"]},{"name":"Editor","guard_name":"web","permissions":["view posts","create posts","update posts"]},{"name":"super_admin","guard_name":"web","permissions":["view_award","view_any_award","create_award","update_award","restore_award","restore_any_award","replicate_award","reorder_award","delete_award","delete_any_award","force_delete_award","force_delete_any_award","view_bookmarks::menu","view_any_bookmarks::menu","create_bookmarks::menu","update_bookmarks::menu","restore_bookmarks::menu","restore_any_bookmarks::menu","replicate_bookmarks::menu","reorder_bookmarks::menu","delete_bookmarks::menu","delete_any_bookmarks::menu","force_delete_bookmarks::menu","force_delete_any_bookmarks::menu","view_company","view_any_company","create_company","update_company","restore_company","restore_any_company","replicate_company","reorder_company","delete_company","delete_any_company","force_delete_company","force_delete_any_company","view_exception","view_any_exception","create_exception","update_exception","restore_exception","restore_any_exception","replicate_exception","reorder_exception","delete_exception","delete_any_exception","force_delete_exception","force_delete_any_exception","view_form","view_any_form","create_form","update_form","restore_form","restore_any_form","replicate_form","reorder_form","delete_form","delete_any_form","force_delete_form","force_delete_any_form","view_form::submission","view_any_form::submission","create_form::submission","update_form::submission","restore_form::submission","restore_any_form::submission","replicate_form::submission","reorder_form::submission","delete_form::submission","delete_any_form::submission","force_delete_form::submission","force_delete_any_form::submission","view_form::type","view_any_form::type","create_form::type","update_form::type","restore_form::type","restore_any_form::type","replicate_form::type","reorder_form::type","delete_form::type","delete_any_form::type","force_delete_form::type","force_delete_any_form::type","view_game","view_any_game","create_game","update_game","restore_game","restore_any_game","replicate_game","reorder_game","delete_game","delete_any_game","force_delete_game","force_delete_any_game","view_profile","view_any_profile","create_profile","update_profile","restore_profile","restore_any_profile","replicate_profile","reorder_profile","delete_profile","delete_any_profile","force_delete_profile","force_delete_any_profile","view_review","view_any_review","create_review","update_review","restore_review","restore_any_review","replicate_review","reorder_review","delete_review","delete_any_review","force_delete_review","force_delete_any_review","view_role","view_any_role","create_role","update_role","delete_role","delete_any_role","view_subscription::type","view_any_subscription::type","create_subscription::type","update_subscription::type","restore_subscription::type","restore_any_subscription::type","replicate_subscription::type","reorder_subscription::type","delete_subscription::type","delete_any_subscription::type","force_delete_subscription::type","force_delete_any_subscription::type","view_tag","view_any_tag","create_tag","update_tag","restore_tag","restore_any_tag","replicate_tag","reorder_tag","delete_tag","delete_any_tag","force_delete_tag","force_delete_any_tag","view_team","view_any_team","create_team","update_team","restore_team","restore_any_team","replicate_team","reorder_team","delete_team","delete_any_team","force_delete_team","force_delete_any_team","view_user","view_any_user","create_user","update_user","restore_user","restore_any_user","replicate_user","reorder_user","delete_user","delete_any_user","force_delete_user","force_delete_any_user","page_Themes","page_FilamentGoogleAnalyticsDashboard","page_ManageBillingSettings","page_ManageGeneralSettings","page_Backups","page_HealthCheckResults","widget_DadJokeWidget","widget_PageViewsWidget","widget_VisitorsWidget","widget_ActiveUsersOneDayWidget","widget_ActiveUsersSevenDayWidget","widget_ActiveUsersFourteenDayWidget","widget_ActiveUsersTwentyEightDayWidget","widget_SessionsWidget","widget_SessionsDurationWidget","widget_SessionsByCountryWidget","widget_SessionsByDeviceWidget","widget_MostVisitedPagesWidget","widget_TopReferrersListWidget"]},{"name":"filament_user","guard_name":"web","permissions":[]}]';
        $directPermissions = '[]';

        static::makeRolesWithPermissions($rolesWithPermissions);
        static::makeDirectPermissions($directPermissions);

        $this->command->info('Shield Seeding Completed.');
    }
}
